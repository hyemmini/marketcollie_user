<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.collie.user.item">
  
  <resultMap id="itemListDomain" type="kr.co.collie.user.item.domain.ItemListDomain" >
  	<result column="ITEM_NUM" property="item_num"/>
  	<result column="ITEM_PRICE" property="item_price"/>
  	<result column="ITEM_NAME" property="item_name"/> 
  	<result column="ITEM_IMG" property="item_img"/>
  </resultMap>
  
  <select id="selectSearchItem"  resultMap="itemListDomain" parameterType="String">
  	select ITEM_NUM, ITEM_PRICE, ITEM_NAME, ITEM_IMG 
  	from ITEM
  	where item_name like '%'||#{item_name}||'%'
  </select>
  
  <select id="selectItemList"  resultMap="itemListDomain" parameterType="kr.co.collie.user.pagination.RangeVO">
  	select ITEM_NUM, ITEM_PRICE, ITEM_NAME, ITEM_IMG
	from(
	  	select ITEM_NUM, ITEM_PRICE, ITEM_NAME, ITEM_IMG, row_number() over(order by item_num) rnum
	  	from ITEM
	  	where
	  	<if test='field_name eq "cate_num".toString()'>
		  	${field_name} = #{field_value}
		</if>
		<if test='field_name eq "item_name".toString()'>
			${field_name} like '%'||#{field_value}||'%'
		</if>
	  	)
	where rnum between #{start_num} and #{end_num}
  </select>
  
  <select id="selectItemListCnt" resultType="int" parameterType="kr.co.collie.user.pagination.RangeVO">
	  	select count(*)
	  	from ITEM
	  		<where>
			  	<if test='field_name eq "cate_num".toString()'>
				  	${field_name} = #{field_value}
			  	</if>
				<if test='field_name eq "item_name".toString()'>
					${field_name} like '%'||#{field_value}||'%'
				</if>	  	
	  		</where>
  </select>
  
</mapper>